<%- include('partials/header') %>

<h1>Shopping Cart</h1>

<% if (cartItems.length === 0) { %>
  <div class="empty-cart">
    <h2>Your cart is empty</h2>
    <p>Start shopping to add items to your cart!</p>
    <a href="/" class="btn">Browse Products</a>
  </div>
<% } else { %>
  <div class="cart-items">
    <% cartItems.forEach(item => { %>
      <div class="cart-item">
        <img src="<%= item.product.imageUrl %>" alt="<%= item.product.name %>">
        <div class="cart-item-details">
          <h3><%= item.product.name %></h3>
          <p class="brand"><%= item.product.brand %></p>
          <p class="price">$<%= item.product.price.toFixed(2) %> each</p>
        </div>
        <div class="cart-item-actions">
          <form action="/cart/update/<%= item.id %>" method="POST" style="display: inline;">
            <input type="number" name="quantity" value="<%= item.quantity %>" min="1" max="<%= item.product.stockQuantity %>">
            <button type="submit" class="btn">Update</button>
          </form>
          <form action="/cart/remove/<%= item.id %>" method="POST" style="display: inline;">
            <button type="submit" class="btn btn-danger">Remove</button>
          </form>
        </div>
        <div>
          <strong>$<%= (item.product.price * item.quantity).toFixed(2) %></strong>
        </div>
      </div>
    <% }); %>
  </div>

  <div class="cart-summary">
    <h2>Total: $<%= total.toFixed(2) %></h2>
    <form action="/orders/checkout" method="POST" style="display: inline;">
      <button type="submit" class="btn btn-success">Proceed to Checkout</button>
    </form>
    <a href="/" class="btn btn-secondary">Continue Shopping</a>
  </div>
<% } %>

<%- include('partials/footer') %>
